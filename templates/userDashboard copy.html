{% extends "new_base.html"%} 

{% block head %}
<head>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
</head>
{% endblock %}

{% block body %}
  <div class="container-fluid">
      <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="pills-home-tab" data-toggle="pill" href="#pills-home" role="tab" aria-controls="pills-home" aria-selected="true">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-profile" role="tab" aria-controls="pills-profile" aria-selected="false">General Overview</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="pills-contact-tab" data-toggle="pill" href="#pills-contact" role="tab" aria-controls="pills-contact" aria-selected="false">Compare</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="export" href="/viewSummary" aria-controls="pills-contact" aria-selected="false">View Summary</a>
          </li>
      </ul>

      <div class="tab-content" id="pills-tabContent">
          
        <div class="tab-pane fade show active" id="pills-home" role="tabpanel">
          <form method="POST" action="{{ url_for('filtered_charts') }}">
            <div class="form-group">
              <label for="hotelName-dropdown">Choose a Hotel</label>
                <select class="custom-select" id="hotelName-dropdown" name="hotelName-dropdown">
                    <option value="">All</option>
                  {% for hotelName in hotelNames %}
                    <option value="{{ hotelName }}">{{ hotelName }}</option>
                  {% endfor%}
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Submit</button>
          </form>
          <br>
            <h1>Welcome, {{ hotelName }}</h1>
              <h3>Map of Hotels in USA against the number of ratings</h3>
            <div>{{ map_div | safe }}</div><br>
            <h3>{{ wordcloud_heading }}</h3>  
            <img src="data:image/png;base64,{{ img_data }}" alt="Word Cloud">
            <h3>Other Hotel Information</h3>
            <table id='analysed_data' class="display">
              <thead>
                <tr>
                  <th>Hotel Name</th>
                  <th>Province</th>
                  <th>Postal Code</th>
                  <th>Categories</th>
                  <th>Primary Categories</th>
                  <th>Compound Sentiment</th>
                  <th>Review Summary</th>
                  <th>Total Reviews</th>
                  <th>Popular Keywords</th>
                  <th>Average Rating</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
              <tfoot>
                <th>Hotel Name</th>
                <th>Province</th>
                <th>Postal Code</th>
                <th>Categories</th>
                <th>Primary Categories</th>
                <th>Compound Sentiment</th>
                <th>Review Summary</th>
                <th>Total Reviews</th>
                <th>Popular Keywords</th>
                <th>Average Rating</th>
              </tfoot>
            </table>
            <br>
            <script>
                $(document).ready( function () {
                    $('#analysed_data').DataTable( {
                        search: {
                        return: true
                        },
                        autoWidth:false, 
                        ajax:{
                            url:'/api/general',
                        },
                        columns: [
                            {data: 'name'},
                            {data: 'province'},
                            {data: 'postalCode'},
                            {data: 'categories', visible:false},
                            {data: 'primaryCategories', visible: false},
                            {data: 'Compound Sentiment', visible: false},
                            {data: 'reviews_summary'},
                            {data: 'reviews_total'},
                            {data: 'popular_keywords', visible: false},
                            {data: 'average_rating'}
                        ]
                    });
                });
            </script>

          </div>

          <div class="tab-pane fade" id="pills-profile" role="tabpanel">
            
            <h1>General Overview</h1>
            <h3>Catergories of the accomodations</h3>
            <div>{{ pie_chart_div|safe }}</div>
            <h3>Average Rating of the accomodations</h3>
            <div>{{ histogram_div|safe }}</div>
            <h3>Correlation of Compound Sentiment</h3>
            <div>{{ correlationgraph|safe}}</div>

            <table id='all_data_table' class="display">
              <thead>
                <tr>
                  <th>Hotel Name</th>
                  <th>Province</th>
                  <th>Postal Code</th>
                  <th>Categories</th>
                  <th>Primary Categories</th>
                  <th>Compound Sentiment</th>
                  <th>Review Summary</th>
                  <th>Total Reviews</th>
                  <th>Popular Keywords</th>
                  <th>Average Rating</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
              <tfoot>
                <th>Hotel Name</th>
                <th>Province</th>
                <th>Postal Code</th>
                <th>Categories</th>
                <th>Primary Categories</th>
                <th>Compound Sentiment</th>
                <th>Review Summary</th>
                <th>Total Reviews</th>
                <th>Popular Keywords</th>
                <th>Average Rating</th>
              </tfoot>
            </table>

            <script>
                $(document).ready( function () {
                    $('#all_data_table').DataTable( {
                        search: {
                        return: true
                        },
                        autoWidth:false,
                        ajax:{
                            url:'/api/general',
                        },
                        columns: [
                            {data: 'name'},
                            {data: 'province'},
                            {data: 'postalCode'},
                            {data: 'categories', visible:false},
                            {data: 'primaryCategories', visible: false},
                            {data: 'Compound Sentiment', visible: false},
                            {data: 'reviews_summary'},
                            {data: 'reviews_total'},
                            {data: 'popular_keywords', visible: false},
                            {data: 'average_rating'}
                        ]
                    });
                });
            </script>
          </div>
          <div class="tab-pane fade" id="pills-contact" role="tabpanel">
            <!-- seperate 2 hotel stuff -->
            <div class="row">
              <div class="col">
                hotel 1
              </div>
              <div class="col">
                hotel 2
              </div>
            </div>
            <!-- new row for insights and bs-->
            <div class="row">
              <div class="col">
                insights
              </div>
            </div>
            <!---->
          </div>
        </div>
</div>
{% endblock %}